# pathtrees_project
Path trees among pairs of trees

                        
    usage: pathtrees.py [-h] [-o OUTPUTDIR] [-v] [-p PLOTFILE] [-n NUMPATHTREES]
                        [-b NUMBESTTREES] [-r NUM_RANDOM_TREES] [-g OUTGROUP]
                        [-i NUM_ITERATIONS] [-e] [-hull] [-gtp] [-nel] [-c COMPARE_TREES]
                        [-interp INTERPOLATION]
                        STARTTREES DATAFILE

Create a geodesic path in the Bilera-Holmes-Vogtman treespace between all trees in the treelist, a treefile and a
sequence data file are mandatory.

    positional arguments:
    
    STARTTREES            
                        mandatory input file that holds a set of trees in Newick format
    
    DATAFILE              
                        mandatory input file that holds a sequence data set in PHYLIP format


    optional arguments:
    
    -h, --help            
                        show this help message and exit
    
    -o OUTPUTDIR, --output OUTPUTDIR
                        directory that holds the output files
                        
    -v, --verbose         
                        Do not remove the intermediate files generated by GPT
    
    -p PLOTFILE, --plot PLOTFILE
                        Create an MDS plot from the generated distances
                        
    -n NUMPATHTREES, --np NUMPATHTREES, --numpathtrees NUMPATHTREES
                        Number of trees along the path between two initial trees
                        
    -b NUMBESTTREES, --best NUMBESTTREES, --numbesttrees NUMBESTTREES
                        Number of trees selected from the best likliehood trees for the next round of refinement
                        
    -r NUM_RANDOM_TREES, --randomtrees NUM_RANDOM_TREES
                        Generate num_random_trees rooted trees using the sequence data individual names.
                        
    -g OUTGROUP, --outgroup OUTGROUP
                        Forces an outgroup when generating random trees.
                        
    -i NUM_ITERATIONS, --iterate NUM_ITERATIONS
                        Takes the trees, generates the pathtrees, then picks the 10 best trees and reruns pathtrees, this will add an iteration number to the outputdir, and also adds iteration to the plotting.
                        
    -e, --extended        
                        If the phylip dataset is in the extended format, use this.
    
    -hull, --convex_hull
                        Extracts the convex hull of input sample trees and considers them as starting trees in the first iteration to generate pairwise pathtrees. If false, it directly considers input sample trees as starting trees in the first iteration to generate pairwise pathtrees.
                        
    -gtp, --gtp_distance    
                        Use GTP derived geodesic distance for MDS plotting [slower], if false use weighted Robinson-Foulds distance for MDS plotting [faster]
                        
    -nel, --neldermead
                        Use Nelder-Mead optimization method to optimize branchlengths [slower], if false use Newton-Raphson to optimize branchlengths [fast]
                        
    -c, --compare_trees
                        String "D1" considers the first dataset (D_1) with two trees to be compared (PAUP and MAP) with the best tree of PATHTREES, string "D2" considers the second dataset (D_2) with two trees to be compared (PAUP and RAxML) with the best tree of PATHTREES, string  "user_trees" considers user_trees to be compared with the best tree of PATHTREES, otherwise it considers nothing to be compared
    -interp, --interpolate
                        Use interpolation scipy.interpolate.griddata for interpolation [more overshooting], or use scipy.interpolate.Rbf [less overshooting]. String "rbf" considers scipy.interpolate.Rbf, Radial basis function (RBF) thin-plate spline interpolation, with default smoothness=1e-10. String "rbf,s_value", for example "rbg,0.0001", considers scipy.interpolate.Rbf with smoothness= s_value= 0.0001. String "cubic" considers scipy.interpolate.griddata, cubic spline interpolation. Otherwise, with None interpolation, it considers default scipy.interpolate.Rbf with smoothness=1e-10
 

			

 
========================  User trees OR Random trees  =========================

How to run user_trees:
        python pathtrees.py -e -n 5 -b 60 -c user_trees  -p myplot -o output SecondData SecondData.phy
  
        
How to run Random trees (create 5 pathtrees between each pair of 10 random trees):
        python pathtrees.py -n 7 -r 10 -c D1 -p myplot -o output FirstData FirstData.phy
  
        
================================  PAPER FIGURES  ==============================

- Figure5 (default value of s=1e-10) : thin-plate spline (Rbf)  
        - Figure 5 (top):
        python pathtrees.py -n 3 -b 15 -gtp -c D1  -p myplot -o output FirstData FirstData.phy 
        
        - Figure 5 (bottom):
        python pathtrees.py -n 3 -gtp -c D1 -p myplot -o output FirstData FirstData.phy 
----------------------------
        
- Figure6 (default value of s=1e-10) : thin-plate spline (Rbf) 
        python pathtrees.py -n 17 -c D1  -p myplot -o output FirstData FirstData.phy
----------------------------

    
- Figure7 (default value of s=1e-10) : thin-plate spline (Rbf)
    python pathtrees.py -e -i 2  -n 6,7 -b 100 -c D2 -p myplot -o output SecondData SecondData.phy
    
----------------------------

Appendix :

- Figure11 : cubic spline (griddata)
    python pathtrees.py -e -interp cubic -i 2  -n 6,7 -b 100 -c D2 -p myplot -o output SecondData SecondData.phy
    
- Figure12 (top) : cubic spline (griddata)
        python pathtrees.py -interp cubic  -n 22 -c D1  -p myplot -o output FirstData FirstData.phy
        
- Figure12 (middle, default value of s=1e-10) : thin-plate spline (Rbf) 
        python pathtrees.py -n 22 -c D1  -p myplot -o output FirstData FirstData.phy
        
 - Figure12 (bottom, s=0.0) : thin-plate spline (Rbf)       
        python pathtrees.py -interp rbf,0.0  -n 22 -c D1  -p myplot -o output FirstData FirstData.phy
        
        
- Figure13 (default value of s=1e-10) : thin-plate spline (Rbf) 
        python pathtrees.py -e -n 6 -c D2 -p myplot -o output SecondData SecondData.phy
----------------------------
